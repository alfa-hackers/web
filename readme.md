# Whirav - Интеллектуальная бизнес-платформа на базе ИИ

### Могут быть баги с истекшим api токенов, тг для оперативной связи
`t.me/vwency`

[![Продакшн](https://img.shields.io/badge/prod-dev.whirav.ru-blue)](https://dev.whirav.ru)
[![Лицензия](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

> Enterprise-решение для малого и среднего бизнеса: интеллектуальная обработка документов, бизнес-аналитика и автоматизация рабочих процессов на базе искусственного интеллекта.

## 🎯 О проекте

Whirav — это комплексная AI-платформа, которая предоставляет владельцам бизнеса:

- **Интеллектуальную обработку** документов PowerPoint, Word, PDF, Excel
- **Бизнес-аналитику** через естественные языковые запросы
- **Контекстную память** с сохранением истории диалогов
- **Автоматическую суммаризацию** контента через трансформеры (@xenova/transformers)

## ✨ Ключевые возможности

### Текущий функционал

- 📄 **Мультиформатность**: Поддержка PPTX, DOCX, PDF, XLSX
- 💬 **Разговорный ИИ**: Контекстно-зависимые диалоги
- 📊 **Бизнес-аналитика**: Запросы к данным на естественном языке
- 🔄 **Протокол**: Web socket
- 🗂️ **Статика**: minio
- 🔐 **Авторизация**: Ory

### Интеллектуальные функции

- **Суммаризация контекста**: Автоматическое сжатие длинных диалогов
- **Анализ файлов**: Глубокий разбор и извлечение бизнес-инсайтов
- **Мультисессионность**: Параллельные диалоги с изолированным контекстом


## 🛠️ Технологический стек

### Backend
- **Фреймворк**: NestJS (Node.js/TypeScript)
- **API**: Fastify, socket-io
- **База данных**: postgresql
- **Кэширование**: redis
- **Хранилище**: MinIO, S3-like
- **Аутентификация**: ORY
- **Документация**: Swagger
- **Пакетный менеджер**: yarn  

### Frontend
- **Фреймворк**: Next.js 16 (React 18+)
- **Язык**: TS
- **Стили**: scss
- **Управление состоянием**: Redux toolkit, axios
- **Пакетный менеджер**: pnpm

### Инфраструктура
- **Контейнеризация**: Docker (multi-stage builds)
- **Reverse Proxy**: nginx-proxy (jwilder)

### Тестирование и качество
- **Unit-тестирование**: Jest
- **Покрытие**: 80%+
- **Линтинг**: ESLint + Prettier
- **Типобезопасность**: TypeScript strict mode

## 📦 Локальная разработка

### Требования

```bash
- Node.js >= 18.x
- Docker >= 24.x
- pnpm >= 8.x
- yarn >= 1.22.x
- direnv (опционально, для управления окружением)
- NestJS >= 10.x
```

### Настройка Backend

```bash
cd backend

cp envrc.example envrc
direnv allow
docker-compose up -d
docker-compose -f docker-compose.kratos.yaml up -d
yarn install
yarn test --coverage
yarn start:dev
```

**Backend доступен по адресу**: `http://localhost:3000`  
**API-документация**: `http://localhost:3000/api`

#### Известные проблемы

> ⚠️ **Сложность инфраструктуры**: Из-за ограниченных временных рамок полная инфраструктура(STAGE/DEV) не была полностью докеризирована. Активно работаем над этим.

### Настройка Frontend

```bash
cd frontend

pnpm install
pnpm test
pnpm dev
```

**Frontend доступен по адресу**: `http://localhost:3001`

### Переменные окружения

Создайте `.env` файлы на основе предоставленных примеров:

**Backend** (`backend/.envrc`):
```
mv .envrc.example .envrc
direnv allow
```

**Frontend** (`frontend/.envrc`):\
(через direnv)
```env
NEXT_PUBLIC_API_URL=http://localhost:3000
NEXT_PUBLIC_WS_URL=ws://localhost:3000
```

## 🏗️ Архитектура

### Текущая архитектура

```
┌─────────────────┐
│   Next.js App   │  (Frontend - React/TypeScript/SCSS)
└────────┬────────┘
         │ HTTP/WebSocket
┌────────▼────────┐
│   NestJS API    │  (Backend - Node.js/TypeScript)
├─────────────────┤
│  Fastify Server │
│   Socket.IO     │
└────┬───┬───┬────┘
     │   │   │
     │   │   └─────────┐
     │   │             │
┌────▼───▼────┐   ┌───▼──────┐   ┌─────────────┐
│  PostgreSQL │   │  MinIO   │   │    Redis    │
│  (TypeORM)  │   │ (Storage)│   │   (Cache)   │
└─────────────┘   └──────────┘   └─────────────┘
```

### Целевая архитектура (будущее)

```
┌──────────────────────────────────────────────────────┐
│                   Клиентский слой                    │
│    (Web, Mobile, Telegram Bot, Desktop)              │
└───────────────────────┬──────────────────────────────┘
                        │
┌───────────────────────▼──────────────────────────────┐
│              API Gateway (Istio)                     │
└───────┬──────────────────────────────┬───────────────┘
        │                              │
┌───────▼────────┐            ┌────────▼──────────┐
│  Presentation  │            │  Аутентификация   │
│     Layer      │            │ (Kratos + Keto)   │
└───────┬────────┘            └───────────────────┘
        │
┌───────▼────────┐
│   Use Cases    │  (Бизнес-логика)
└───────┬────────┘
        │
┌───────▼────────┐       ┌──────────────┐
│    Services    │◄──────┤  Event Bus   │
│   (Domain)     │       │   (Kafka)    │
└───────┬────────┘       └──────────────┘
        │
┌───────▼────────┐
│   Entities     │  (Доменные модели)
└───────┬────────┘
        │
┌───────▼────────────────────────────────┐
│     Ports & Adapters (Infrastructure)  │
├────────┬──────────┬──────────┬─────────┤
│   DB   │  Cache   │ Storage  │   MQ    │
│ (PG)   │ (Redis)  │ (MinIO)  │ (Kafka) │
└────────┴──────────┴──────────┴─────────┘
```

## 📊 Состояние проекта

### Текущий статус

Проект находится в активной разработке (MVP-стадия). Реализован базовый функционал обработки документов и аналитики. Архитектура заложена с прицелом на масштабирование, но требует рефакторинга для полного соответствия DDD-принципам.

### Что работает стабильно
- ✅ Загрузка и обработка документов (PDF, PPTX, DOCX, XLSX)
- ✅ AI-ассистент с поддержкой контекста
- ✅ Хранение истории диалогов
- ✅ Real-time коммуникация через WebSocket
- ✅ Базовая аутентификация

### В процессе разработки
- 🔄 Полная докеризация инфраструктуры
- 🔄 Покрытие тестами (текущий показатель ~60%)
- 🔄 Оптимизация производительности
- 🔄 UI/UX-полировка

### Технический долг
- ⚠️ Миграция на полноценный DDD с четким разделением слоев
- ⚠️ Внедрение CQRS для улучшения читаемости кода
- ⚠️ Рефакторинг фронтенда: выделение переиспользуемых компонентов
- ⚠️ Документация API (Swagger частично)


## 📞 Контакты

t.me/vwency - backend/frontend, team lead  
t.me/SaCorv - Ответсвенный за сервер  
t.me/SyncI20n - Ответсвенный за UI/UX  
t.me/MurkyShadow -Менеджер, Product manager, контроль соответсвия требованиям  

- **Сайт**: [https://dev.whirav.ru](https://dev.whirav.ru)
- **Документация API**: [https://api.whirav.ru/api](https://api.whirav.ru/api)


![alt text](art/knight-fighting-dragon-depicting-fantasy-battle-mythical-creatures-versus-scene-representing-knights-dragons-battles-stock-371249438.webp)
